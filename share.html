<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>LouvorIBI</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body class="share-bg">

<header class="share-top">
  <div class="brand">LouvorIBI</div>
</header>

<main class="share-main">
  <div id="shareList"></div>
</main>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  const repEncoded = qs.get('rep') || '';
  const titleCustom = qs.get('title') || 'LouvorIBI';

  // ===========================
  // CORREÇÃO DA DATA NO TÍTULO
  // ===========================
  // Espera receber algo como: LouvorIBI-07-12-2025
  let tituloFinal = titleCustom;

  if(titleCustom.includes("-")){
    const partes = titleCustom.split("-");
    if(partes.length >= 4){
      const nome = partes[0];
      const dia  = partes[1];
      const mes  = partes[2];
      const ano  = partes[3];

      const dataFormatada = `${dia}/${mes}/${ano}`; 
      tituloFinal = `${nome} – ${dataFormatada}`;
    }
  }

  document.title = tituloFinal;
  document.querySelector('.brand').textContent = tituloFinal;

  // ===========================
  // MOSTRAR O REPERTÓRIO
  // ===========================
  const container = document.getElementById('shareList');
  container.innerHTML = '';
  try {
    const rep = JSON.parse(decodeURIComponent(repEncoded));
    rep.forEach(item=>{
      const div = document.createElement('div');
      div.className='mus-item';
      div.innerHTML = `
        <p><strong>Música:</strong> ${item.musica}</p>
        <p><strong>Tom:</strong> ${item.tom}</p>
        <p><strong>Ministro(a):</strong> ${item.ministro}</p>
        <div class="link-buttons">
          <button class="btn letra" onclick="window.open('${item.letra}','_blank')">Letra</button>
          <button class="btn cifra" onclick="window.open('${item.cifra}','_blank')">Cifra</button>
          <button class="btn youtube" onclick="window.open('${item.youtube}','_blank')">YouTube</button>
        </div>
      `;
      container.appendChild(div);
    });
  } catch(e){
    container.innerHTML = '<p>Não foi possível carregar o repertório.</p>';
  }
})();
</script>
</body>
</html>
